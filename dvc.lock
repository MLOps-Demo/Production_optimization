schema: '2.0'
stages:
  create-dataset:
    cmd: python src/create_dataset.py
    deps:
    - path: data/original_dataset/clean_data.csv
      md5: f0cd8ff9e7cd4a7e86ab7074c7055dab
      size: 199942
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/create_dataset.py
      md5: c1c09dfbf2072937befc14bbad1637f3
      size: 986
    outs:
    - path: data/cleaned_data/dataset.csv
      md5: 6e032aac042ee4bbd4b47ca55fa02af9
      size: 199998
  anomaly-detect:
    cmd: python src/anomaly_detect.py
    deps:
    - path: data/cleaned_data/dataset.csv
      md5: 6e032aac042ee4bbd4b47ca55fa02af9
      size: 199998
    - path: src/anomaly_detect.py
      md5: 3658712eae35a721c83b0671fa68a2d8
      size: 7114
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    params:
      params.yaml:
        anomaly_detect.anomaly_contamination: 0.005
        anomaly_detect.seed: 42
    outs:
    - path: anomaly_summary.json
      md5: 3deba3596aef89fdb4e74c966467971c
      size: 98
    - path: data/anomaly_treated/anomalous_data.csv
      md5: 4c95a345120602a7098d6f15f99cbbc6
      size: 1563
    - path: data/anomaly_treated/anomaly_treated_data.csv
      md5: d5a9e965458a89003b41d7e71a049ab4
      size: 198580
    - path: data/plots_figs/anomaly_detect_plt_pca.png
      md5: a42c4df40e5b695a6f27d0d98acce0a9
      size: 160214
    - path: data/plots_figs/anomaly_detect_plt_tsne.png
      md5: f80fa9931c42d6899b7b28b505096195
      size: 150860
  data-split:
    cmd: python src/data_split.py
    deps:
    - path: data/anomaly_treated/anomaly_treated_data.csv
      md5: d5a9e965458a89003b41d7e71a049ab4
      size: 198580
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/data_split.py
      md5: eaad548eed77478c1236bd1645b6a444
      size: 1257
    params:
      params.yaml:
        data-split.seed: 42
        data-split.split: 0.2
    outs:
    - path: data/features/x_test.npy
      md5: 0b5144e2e28e3b078a0210c45c93db85
      size: 23232
    - path: data/features/x_train.npy
      md5: d2f31e209ef7f348325fae30630bad17
      size: 92480
    - path: data/features/y_test.npy
      md5: fac680e59306b7b4aaf8defc4b116dde
      size: 3016
    - path: data/features/y_train.npy
      md5: 543dbb36ee6ddfcae7f74e62518100fa
      size: 11672
  normalize:
    cmd: python src/normalize.py
    deps:
    - path: data/features/x_test.npy
      md5: 0b5144e2e28e3b078a0210c45c93db85
      size: 23232
    - path: data/features/x_train.npy
      md5: d2f31e209ef7f348325fae30630bad17
      size: 92480
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/normalize.py
      md5: 778bdb4b6ef651f30c4857affe3778c4
      size: 741
    outs:
    - path: data/models/scaling_model.pkl
      md5: 232aa0d0511057e9574f7e1a2be4b71d
      size: 642
  training:
    cmd: python src/training.py
    deps:
    - path: data/features/x_train.npy
      md5: d2f31e209ef7f348325fae30630bad17
      size: 92480
    - path: data/features/y_train.npy
      md5: 543dbb36ee6ddfcae7f74e62518100fa
      size: 11672
    - path: data/models/scaling_model.pkl
      md5: 232aa0d0511057e9574f7e1a2be4b71d
      size: 642
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/learning_curves.py
      md5: d469beacdc401742c0d8c24a3a0c5309
      size: 4121
    - path: src/training.py
      md5: 5b48b0524f65cbad0558c19fd3b82210
      size: 2033
    params:
      params.yaml:
        training.lr: 0.02
        training.m_depth: 4
        training.min_leaf: 6
        training.min_split: 6
        training.n_est: 150
    outs:
    - path: data/models/gbrt_model.pkl
      md5: 5e57a569922689acb4c993081f933871
      size: 290654
    - path: data/plots_figs/learning_curve.png
      md5: 3916bee4b9db87d12cd36f2caa05f31c
      size: 215977
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: data/features/x_test.npy
      md5: 0b5144e2e28e3b078a0210c45c93db85
      size: 23232
    - path: data/features/y_test.npy
      md5: fac680e59306b7b4aaf8defc4b116dde
      size: 3016
    - path: data/models/gbrt_model.pkl
      md5: 5e57a569922689acb4c993081f933871
      size: 290654
    - path: data/models/scaling_model.pkl
      md5: 232aa0d0511057e9574f7e1a2be4b71d
      size: 642
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/evaluate.py
      md5: 034d0c8d082cd72d09030b8025cef71d
      size: 1581
    outs:
    - path: data/plots_figs/deviance.png
      md5: 16233c8f68f5e953875e7358a465d33e
      size: 53331
    - path: data/plots_figs/feature_importance.png
      md5: ab1c6d6902d69959b6369d7b211110bd
      size: 71332
    - path: data/predictions/prediction.csv
      md5: bb0e4006e479f9f030c1afd43ecc36c9
      size: 8959
    - path: scores.json
      md5: 6bd22e3e4f0255b33c8551c203af0539
      size: 66
