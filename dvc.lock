schema: '2.0'
stages:
  create-dataset:
    cmd: python src/create_dataset.py
    deps:
    - path: data/original_dataset/clean_data.csv
      md5: f0cd8ff9e7cd4a7e86ab7074c7055dab
      size: 199942
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/create_dataset.py
      md5: c1c09dfbf2072937befc14bbad1637f3
      size: 986
    outs:
    - path: data/cleaned_data/dataset.csv
      md5: 6e032aac042ee4bbd4b47ca55fa02af9
      size: 199998
  anomaly-detect:
    cmd: python src/anomaly_detect.py
    deps:
    - path: data/cleaned_data/dataset.csv
      md5: 6e032aac042ee4bbd4b47ca55fa02af9
      size: 199998
    - path: src/anomaly_detect.py
      md5: f9d3181acbb2c17d432ded04fa24e5bb
      size: 6804
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    params:
      params.yaml:
        anomaly_detect.anomaly_contamination: 0.005
        anomaly_detect.seed: 36
    outs:
    - path: data/anomaly_treated/anomalous_data.csv
      md5: e1b61058d0c43da0f4aef41f030f3c19
      size: 1453
    - path: data/anomaly_treated/anomaly_treated_data.csv
      md5: cc56578cc25d9a4a676066a71021e72b
      size: 198690
    - path: data/plots_figs/anomaly_detect_plt_pca.png
      md5: 4840bf67627b4f53dee109abc0c3c2b0
      size: 160113
    - path: data/plots_figs/anomaly_detect_plt_tsne.png
      md5: 82f9e1541f5afbb890d1d03ee87de484
      size: 155440
  data-split:
    cmd: python src/data_split.py
    deps:
    - path: data/anomaly_treated/anomaly_treated_data.csv
      md5: cc56578cc25d9a4a676066a71021e72b
      size: 198690
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/data_split.py
      md5: eaad548eed77478c1236bd1645b6a444
      size: 1257
    params:
      params.yaml:
        data-split.seed: 42
        data-split.split: 0.2
    outs:
    - path: data/features/x_test.npy
      md5: 7f873ca44bd457a53a7da1cb5bef5638
      size: 23232
    - path: data/features/x_train.npy
      md5: 673275949d1ca7c79a67e4dcde6eb753
      size: 92544
    - path: data/features/y_test.npy
      md5: 934fc38444a429dc7adffa7ec2c8a3cb
      size: 3016
    - path: data/features/y_train.npy
      md5: 5bcbee4df3dd45eae547c682bd5b0f69
      size: 11680
  normalize:
    cmd: python src/normalize.py
    deps:
    - path: data/features/x_test.npy
      md5: 7f873ca44bd457a53a7da1cb5bef5638
      size: 23232
    - path: data/features/x_train.npy
      md5: 673275949d1ca7c79a67e4dcde6eb753
      size: 92544
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/normalize.py
      md5: 778bdb4b6ef651f30c4857affe3778c4
      size: 741
    outs:
    - path: data/models/scaling_model.pkl
      md5: 90d2a667baa70dd32ec23182e1a10fe4
      size: 641
  training:
    cmd: python src/training.py
    deps:
    - path: data/features/x_train.npy
      md5: 673275949d1ca7c79a67e4dcde6eb753
      size: 92544
    - path: data/features/y_train.npy
      md5: 5bcbee4df3dd45eae547c682bd5b0f69
      size: 11680
    - path: data/models/scaling_model.pkl
      md5: 90d2a667baa70dd32ec23182e1a10fe4
      size: 641
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/learning_curves.py
      md5: 841fbd4d73f7ccdce9062de33508cf99
      size: 4007
    - path: src/training.py
      md5: c7a7217e494adbec88ba701967384bbc
      size: 1996
    params:
      params.yaml:
        training.lr: 0.02
        training.m_depth: 4
        training.min_leaf: 5
        training.min_split: 6
        training.n_est: 100
    outs:
    - path: data/models/gbrt_model.pkl
      md5: 3e38660969ce56917b410a8aa279a576
      size: 200609
    - path: data/plots_figs/learning_curve.png
      md5: 00af88be83df6af161df25b7e1aa2c5b
      size: 86967
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: data/features/x_test.npy
      md5: 7f873ca44bd457a53a7da1cb5bef5638
      size: 23232
    - path: data/features/y_test.npy
      md5: 934fc38444a429dc7adffa7ec2c8a3cb
      size: 3016
    - path: data/models/gbrt_model.pkl
      md5: 3e38660969ce56917b410a8aa279a576
      size: 200609
    - path: data/models/scaling_model.pkl
      md5: 90d2a667baa70dd32ec23182e1a10fe4
      size: 641
    - path: src/config.py
      md5: fb091cc52a55961ad7794da791d7471f
      size: 509
    - path: src/evaluate.py
      md5: 0806cab9a76b63651d3f11ce66f932b8
      size: 1559
    outs:
    - path: data/plots_figs/deviance.png
      md5: b16c98ee0bed116c259b870f411d2278
      size: 35473
    - path: data/plots_figs/feature_importance.png
      md5: f591dfc678f4123047c7358f64aaf8d9
      size: 46159
    - path: data/predictions/prediction.csv
      md5: 92fbd961386aac0c2e7f4ef8a416f26e
      size: 8958
    - path: scores.json
      md5: 54901769c957da98dd075d5a469c4329
      size: 66
